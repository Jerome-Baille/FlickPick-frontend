<section class="create-group-container">
  <div class="create-group-content">
    <!-- Header -->
    <div class="page-header">
      <h1 class="page-title">Create a Group</h1>
      <p class="page-subtitle">Start a new friend group for movie nights. You can invite members now or share the group code later.</p>
    </div>

    <!-- Group Name Section -->
    <div class="form-section">
      <h2 class="section-title">Group Details</h2>
      <mat-form-field appearance="outline" class="group-name-field">
        <mat-label>Group Name</mat-label>
        <input matInput [(ngModel)]="groupName" placeholder="e.g., Friday Movie Crew" maxlength="50">
        <mat-icon matPrefix>groups</mat-icon>
        <mat-hint>{{ groupName.length }}/50</mat-hint>
      </mat-form-field>
    </div>

    <!-- Members Section -->
    <div class="form-section">
      <h2 class="section-title">Invite Members (Optional)</h2>
      <p class="section-hint">Add members by email. They'll receive an invitation when the group is created.</p>
      
      <div class="member-input-row">
        <mat-form-field appearance="outline" class="email-field">
          <mat-label>Member Email</mat-label>
          <input 
            matInput 
            [(ngModel)]="memberEmail" 
            placeholder="friend@example.com"
            type="email"
            (keydown)="handleEmailKeydown($event)"
          >
          <mat-icon matPrefix>email</mat-icon>
        </mat-form-field>
        <button class="btn-add-member" (click)="addMember()" [disabled]="!memberEmail.trim()">
          <span class="material-symbols-outlined">person_add</span>
          Add
        </button>
      </div>

      <!-- Invited Members List -->
      @if (invitedMembers.length > 0) {
        <div class="invited-members">
          <h3 class="members-title">Invited Members ({{ invitedMembers.length }})</h3>
          <div class="members-list">
            @for (member of invitedMembers; track member.id) {
              <div class="member-chip">
                <div class="member-avatar">{{ member.initials }}</div>
                <span class="member-email">{{ member.email }}</span>
                <button class="btn-remove-member" (click)="removeMember(member.id)" title="Remove member">
                  <span class="material-symbols-outlined">close</span>
                </button>
              </div>
            }
          </div>
        </div>
      }
    </div>

    <!-- Info Card -->
    <div class="info-card">
      <span class="material-symbols-outlined info-icon">info</span>
      <div class="info-content">
        <p class="info-title">How it works</p>
        <p class="info-text">After creating the group, you'll get a unique code that anyone can use to join. You can also create movie night events where your group votes on what to watch!</p>
      </div>
    </div>

    <!-- Actions -->
    <div class="form-actions">
      <button class="btn-secondary" (click)="goBack()">Cancel</button>
      <button class="btn-primary" (click)="createGroup()" [disabled]="!canCreateGroup || isSubmitting">
        @if (isSubmitting) {
          <span class="material-symbols-outlined spin">progress_activity</span>
          Creating...
        } @else {
          <span class="material-symbols-outlined">group_add</span>
          Create Group
        }
      </button>
    </div>
  </div>
</section>
